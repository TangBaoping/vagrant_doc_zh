<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">

		<title> Creating a Base Box - VirtualBox Provider - Vagrant Documentation</title>

		<!-- meta -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<!-- lib styles -->
		<link href="../../stylesheets/bootstrap-2bdef9a2.css" tppabs="http://docs.vagrantup.com/stylesheets/bootstrap-2bdef9a2.css" media="screen" rel="stylesheet" type="text/css" />
<link href="../../stylesheets/vagrantup-71e7d178.css" tppabs="http://docs.vagrantup.com/stylesheets/vagrantup-71e7d178.css" media="screen" rel="stylesheet" type="text/css" />

		<!-- lib js -->
		<script src="../../javascripts/jquery-08c11650.js" tppabs="http://docs.vagrantup.com/javascripts/jquery-08c11650.js" type="text/javascript"></script>
		<script src="../../javascripts/modernizr-84c0465a.js" tppabs="http://docs.vagrantup.com/javascripts/modernizr-84c0465a.js" type="text/javascript"></script>
		<script src="../../javascripts/bootstrap.min-98cc7a22.js" tppabs="http://docs.vagrantup.com/javascripts/bootstrap.min-98cc7a22.js" type="text/javascript"></script>
		<script src="../../javascripts/backstretch-3d1212ad.js" tppabs="http://docs.vagrantup.com/javascripts/backstretch-3d1212ad.js" type="text/javascript"></script>
		<script src="../../javascripts/vagrantup-03aae2a8.js" tppabs="http://docs.vagrantup.com/javascripts/vagrantup-03aae2a8.js" type="text/javascript"></script>

		<!-- fonts -->
		<link href="../../../fonts.googleapis.com/css-family=Inconsolata.css" tppabs="http://fonts.googleapis.com/css?family=Inconsolata" rel='stylesheet' type='text/css'>
		<script type="text/javascript" src="../../../use.typekit.net/xfs6zus.js" tppabs="http://use.typekit.net/xfs6zus.js"></script>
		<script type="text/javascript">try{Typekit.load();}catch(e){}</script>

		<!-- Google analytics -->
		<script type="text/javascript">

			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-15091924-1']);
			_gaq.push(['_trackPageview']);

			(function() {
			 var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www/') + '.google-analytics.com/ga.js';
			 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			 })();

		 </script>
	</head>
	<body>
		<!-- wrap everything -->
		<div class="wrapper">

			<!-- nav -->

			<nav class="docs">
			<!-- vagrant logo -->
			<a class="vagrant-docs-logo" href="javascript:if(confirm(%27https://docs.vagrantup.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://docs.vagrantup.com/%27" tppabs="http://docs.vagrantup.com/">Vagrant Documentation</a>
			<!-- nav -->
			<ul class="pull-right unstyled">
				<li class="pill">
					<a href="javascript:if(confirm(%27http://www.amazon.com/gp/product/1449335837/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449335837&linkCode=as2&tag=vagrant-20  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.amazon.com/gp/product/1449335837/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449335837&linkCode=as2&tag=vagrant-20%27" tppabs="http://www.amazon.com/gp/product/1449335837/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449335837&linkCode=as2&tag=vagrant-20">
						Vagrant Book
					</a>
				</li>
				<li><a href="javascript:if(confirm(%27http://www.vagrantup.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.vagrantup.com/%27" tppabs="http://www.vagrantup.com/">Home</a></li>
			</ul>
			</nav>

			<div class="page docs docs-home">
				<div class="container">
					<div class="row">

						<div class="sidebar span3">
							<!-- get the sidebar nav -->
							<!-- side nav docs -->
							<aside class="sidebar-nav">

							<div class="toggle hidden-desktop">
								<div class="open-close open"></div>
								<a href="#">Contents</a>
							</div>

							<ul class="unstyled">
								<li><a href="../index.html" tppabs="http://docs.vagrantup.com/v2/">Overview</a></li>

								<li><a href="../why-vagrant/index.html" tppabs="http://docs.vagrantup.com/v2/why-vagrant/index.html">Why Vagrant?</a></li>

								<li><a href="../installation/index.html" tppabs="http://docs.vagrantup.com/v2/installation/index.html">Installation</a></li>
								

								<li><a href="../getting-started/index.html" tppabs="http://docs.vagrantup.com/v2/getting-started/index.html">Getting Started</a></li>
								

								<li><a href="../cli/index.html" tppabs="http://docs.vagrantup.com/v2/cli/index.html">Command-Line Interface</a></li>
								

								<li ><a href="../share/index.html" tppabs="http://docs.vagrantup.com/v2/share/index.html">Vagrant Share</a></li>
								

								<li ><a href="../vagrantfile/index.html" tppabs="http://docs.vagrantup.com/v2/vagrantfile/index.html">Vagrantfile</a></li>
								

								<li><a href="../boxes.html" tppabs="http://docs.vagrantup.com/v2/boxes.html">Boxes</a></li>
								

								<li><a href="../provisioning/index.html" tppabs="http://docs.vagrantup.com/v2/provisioning/index.html">Provisioning</a></li>
								

								<li><a href="../networking/index.html" tppabs="http://docs.vagrantup.com/v2/networking/index.html">Networking</a></li>
								

								<li><a href="../synced-folders/index.html" tppabs="http://docs.vagrantup.com/v2/synced-folders/index.html">Synced Folders</a></li>
								

								<li><a href="../multi-machine/index.html" tppabs="http://docs.vagrantup.com/v2/multi-machine/index.html">Multi-Machine</a></li>

								<li><a href="../providers/index.html" tppabs="http://docs.vagrantup.com/v2/providers/index.html">Providers</a></li>
								

								

								
								<li class="current"><a href="index.html" tppabs="http://docs.vagrantup.com/v2/virtualbox/index.html">VirtualBox</a></li>
								
								<ul class="sub unstyled">
									<li><a href="usage.html" tppabs="http://docs.vagrantup.com/v2/virtualbox/usage.html">Usage</a></li>
									<li class="current"><a href="boxes.html" tppabs="http://docs.vagrantup.com/v2/virtualbox/boxes.html">Creating a Base Box</a></li>
									<li><a href="configuration.html" tppabs="http://docs.vagrantup.com/v2/virtualbox/configuration.html">Configuration</a></li>
									<li><a href="networking.html" tppabs="http://docs.vagrantup.com/v2/virtualbox/networking.html">Networking</a></li>
									<li><a href="common-issues.html" tppabs="http://docs.vagrantup.com/v2/virtualbox/common-issues.html">Common Issues</a></li>
								</ul>
								
							  

								

								

								<li><a href="../plugins/index.html" tppabs="http://docs.vagrantup.com/v2/plugins/index.html">Plugins</a></li>
								

								<li><a href="../push/index.html" tppabs="http://docs.vagrantup.com/v2/push/index.html">Push</a></li>

								

								<li><a href="../other/index.html" tppabs="http://docs.vagrantup.com/v2/other/index.html">Other</a></li>

								
							</ul>
							</aside> <!-- /.sidebar -->
						</div> <!-- /.sidebar -->

						<div class="page-contents span9">
							<div class="page-background"></div>

							<!-- start page content -->
							<div class="row">
								<div class="span8 offset1">
									<h1>Creating a Base Box</h1>

<p>As with <a href="../providers/basic_usage.html" tppabs="http://docs.vagrantup.com/v2/providers/basic_usage.html">every provider</a>, the VirtualBox
provider has a custom box format that affects how base boxes are made.</p>

<p>Prior to reading this, you should read the
<a href="../boxes/base.html" tppabs="http://docs.vagrantup.com/v2/boxes/base.html">general guide to creating base boxes</a>. Actually,
it would probably be most useful to keep this open in a separate tab
as you may be referencing it frequently while creating a base box. That
page contains important information about common software to install
on the box.</p>

<p>Additionally, it is helpful to understand the
<a href="../boxes/format.html" tppabs="http://docs.vagrantup.com/v2/boxes/format.html">basics of the box file format</a>.</p>

<div class="alert alert-block alert-warn">
    <p>
        <strong>Advanced topic!</strong> This is a reasonably advanced topic that
        a beginning user of Vagrant doesn't need to understand. If you're
        just getting started with Vagrant, skip this and use an available
        box. If you're an experienced user of Vagrant and want to create
        your own custom boxes, this is for you.
    </p>
</div>

<h2>Virtual Machine</h2>

<p>The virtual machine created in VirtualBox can use any configuration you&#39;d
like, but Vagrant has some hard requirements:</p>

<ul>
<li><p>The first network interface (adapter 1) <em>must</em> be a NAT adapter.
Vagrant uses this to connect the first time.</p></li>
<li><p>The MAC address of the first network interface (the NAT adapter)
should be noted, since you&#39;ll need to put it in a Vagrantfile
later as the value for <code>config.vm.base_mac</code>. To get this value, use
the VirtualBox GUI.</p></li>
</ul>

<p>Other than the above, you&#39;re free to customize the base virtual machine
as you see fit.</p>

<h2>Additional Software</h2>

<p>In addition to the software that should be installed based on the
<a href="../boxes/base.html" tppabs="http://docs.vagrantup.com/v2/boxes/base.html">general guide to creating base boxes</a>,
VirtualBox base boxes require some additional software.</p>

<h3>VirtualBox Guest Additions</h3>

<p><a href="javascript:if(confirm(%27http://www.virtualbox.org/manual/ch04.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.virtualbox.org/manual/ch04.html%27" tppabs="http://www.virtualbox.org/manual/ch04.html">VirtualBox Guest Additions</a>
must be installed so that things such as shared folders can function.
Installing guest additions also usually improves performance since the guest
OS can make some optimizations by knowing it is running within VirtualBox.</p>

<p>Before installing the guest additions, you&#39;ll need the linux kernel headers
and the basic developer tools. On Ubuntu, you can easily install these like
so:</p>

<pre><code>$ sudo apt-get install linux-headers-generic build-essential dkms
</code></pre>

<h4>To install via the GUI:</h4>

<p>Next, make sure that the guest additions image is available by using the
GUI and clicking on &quot;Devices&quot; followed by &quot;Install Guest Additions&quot;.
Then mount the CD-ROM to some location. On Ubuntu, this usually looks like
this:</p>

<pre><code>$ sudo mount /dev/cdrom /media/cdrom
</code></pre>

<p>Finally, run the shell script that matches your system to install the
guest additions. For example, for Linux on x86, it is the following:</p>

<pre><code>$ sudo sh /media/cdrom/VBoxLinuxAdditions.run
</code></pre>

<p>If the command succeeds, then the guest additions are now installed!</p>

<h4>To install via the command line:</h4>

<p>You can find the appropriate guest additions version to match your VirtualBox
version by selecting the appropriate version
<a href="javascript:if(confirm(%27http://download.virtualbox.org/virtualbox/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://download.virtualbox.org/virtualbox/%27" tppabs="http://download.virtualbox.org/virtualbox/">here</a>. The examples below use
4.3.8, which was the latest VirtualBox version at the time of writing.</p>

<pre><code>wget http://download.virtualbox.org/virtualbox/4.3.8/VBoxGuestAdditions_4.3.8.iso
sudo mkdir /media/VBoxGuestAdditions
sudo mount -o loop,ro VBoxGuestAdditions_4.3.8.iso /media/VBoxGuestAdditions
sudo sh /media/VBoxGuestAdditions/VBoxLinuxAdditions.run
rm VBoxGuestAdditions_4.3.8.iso
sudo umount /media/VBoxGuestAdditions
sudo rmdir /media/VBoxGuestAdditions
</code></pre>

<p>If you didnâ€™t install a Desktop environment when you installed the operating
system, as recommended to reduce size, the install of the VirtualBox additions
should warn you about the lack of OpenGL or Window System Drivers, but you can
safely ignore this.</p>

<p>If the commands succeed, then the guest additions are now installed!</p>

<h2>Packaging the Box</h2>

<p>Vagrant includes a simple way to package VirtualBox base boxes. Once you&#39;ve
installed all the software you want to install, you can run this command:</p>

<pre><code>$ vagrant package --base my-virtual-machine
</code></pre>

<p>Where &quot;my-virtual-machine&quot; is replaced by the name of the virtual machine
in VirtualBox to package as a base box.</p>

<p>It will take a few minutes, but after it is complete, a file &quot;package.box&quot;
should be in your working directory which is the new base box. At this
point, you&#39;ve successfully created a base box!</p>

<h2>Raw Contents</h2>

<p>This section documents the actual raw contents of the box file. This isn&#39;t
as useful when creating a base box but can be useful in debugging issues
if necessary.</p>

<p>A VirtualBox base box is an archive of the resulting files of
<a href="javascript:if(confirm(%27http://www.virtualbox.org/manual/ch08.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.virtualbox.org/manual/ch08.html#vboxmanage-export%27" tppabs="http://www.virtualbox.org/manual/ch08.html#vboxmanage-export">exporting</a>
a VirtualBox virtual machine. Here is an example of what is contained
in such a box:</p>

<pre><code>$ tree
.
|-- Vagrantfile
|-- box-disk1.vmdk
|-- box.ovf
|-- metadata.json

0 directories, 4 files
</code></pre>

<p>In addition to the files from exporting a VirtualBox VM, there is
the &quot;metadata.json&quot; file used by Vagrant itself.</p>

<p>Also, there is a &quot;Vagrantfile.&quot; This contains some configuration to
properly set the MAC address of the NAT network device, since VirtualBox
requires this to be correct in order to function properly. If you&#39;re
not using <code>vagrant package --base</code> above, you&#39;ll have to set the
<code>config.vm.base_mac</code> setting in this Vagrantfile to the MAC address
of the NAT device without colons.</p>

<p>When bringing up a VirtualBox backed machine, Vagrant
<a href="javascript:if(confirm(%27http://www.virtualbox.org/manual/ch08.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.virtualbox.org/manual/ch08.html#vboxmanage-import%27" tppabs="http://www.virtualbox.org/manual/ch08.html#vboxmanage-import">imports</a>
the first &quot;ovf&quot; file found in the box contents.</p>

								</div> <!-- /.span8 -->
							</div> <!-- /.row -->
						</div> <!-- /.page-contents -->
					</div> <!-- /.row -->
				</div> <!-- /.container -->
			</div> <!-- /.page -->

			<!-- footer -->
			<footer>
			<div class="container">
				<div class="row">
					<div class="span12">

						<ul class="unstyled footer-nav">
							<li><a href="javascript:if(confirm(%27https://docs.vagrantup.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://docs.vagrantup.com/%27" tppabs="http://docs.vagrantup.com/">Documentation</a></li>
							<li><a href="javascript:if(confirm(%27http://www.vagrantup.com/about  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.vagrantup.com/about%27" tppabs="http://www.vagrantup.com/about">About</a></li>
							<li><a href="javascript:if(confirm(%27http://www.vagrantup.com/support  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.vagrantup.com/support%27" tppabs="http://www.vagrantup.com/support">Support</a></li>
							<a href="javascript:if(confirm(%27http://www.vagrantup.com/downloads  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.vagrantup.com/downloads%27" tppabs="http://www.vagrantup.com/downloads">
								<li class="button inline-button">Download</li>
							</a>
						</ul>

						<ul class="unstyled logos">
							<a href="javascript:if(confirm(%27http://www.vagrantup.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.vagrantup.com/%27" tppabs="http://www.vagrantup.com/">
								<li class="vagrant-logo-monochrome"></li>
							</a>
							<li><span>by</span></li>
							<a href="javascript:if(confirm(%27http://www.hashicorp.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.hashicorp.com/%27" tppabs="http://www.hashicorp.com/">
								<li class="hashi-logo-monochrome "></li>
							</a>
						</ul> <!-- /span -->

					</div> <!-- /span -->
				</div> <!-- /row -->

				<div class="row">
					<h6 class="legal">
						Copyright &copy; 2015 HashiCorp
					</h6>
				</div> <!-- row -->
			</div> <!-- container -->
			</footer>

			<!-- close .wrapper -->
		</div>

		<!-- load scripts -->
		<!-- load full-width image into any div with class="big-background -->
		<script>
			$(".big-background").backstretch("assets/photos/full_width.jpg"/*tpa=http://docs.vagrantup.com/v2/virtualbox/assets/photos/full_width.jpg*/);
		</script>
	</body>
</html>
